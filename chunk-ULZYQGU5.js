import{a as w}from"./chunk-TIFEMM4O.js";import{c as f}from"./chunk-3IWGPNNC.js";import{Aa as m,Hb as v,O as l,Qb as h,T as c,_a as d,d as M,ea as i,jb as u,kb as g}from"./chunk-2FEQYACG.js";var o=M(w());var C=()=>window.navigator.geolocation,s=class r{geolocation=i(C());currentPosition=i(null);constructor(){this.getCurrentLocation()}getCurrentLocation(){this.geolocation().getCurrentPosition(e=>{this.currentPosition.set(e)})}getWatchPosition(){}stopWatchPosition(){this.geolocation().clearWatch}static \u0275fac=function(t){return new(t||r)};static \u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"})};var b=["map"],p=class r{geoservice=c(s);acultural=c(f);mapDiv=v("map");map=i(null);coords=i(null);events=i(this.acultural.eventosMap());constructor(){this.coords.set(this.getCoordsCurrentPosition())}getCoordsCurrentPosition(){let e=this.geoservice.currentPosition(),t;if(!e)return t=new o.default.LatLng(41.3231,2.013304),t;let n=e.coords.latitude,a=e.coords.longitude;return t=new o.default.LatLng(n,a),t}getMapOptions(){let e=new o.default.LatLng(41.3231,2.013304);return{attributionControl:!0,doubleClickZoom:!0,center:this.coords()??e,zoomSnap:.5,zoomControl:!0,fadeAnimation:!0,zoomAnimation:!0,scrollWheelZoom:!0,dragging:!0,maxZoom:18,minZoom:6}}getOptionsMarker(){return{icon:new o.default.DivIcon({html:`<div style='color:blue;font-size:5px;text-shadow:2px 2px 1px black'>
                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-geo-alt-fill" viewBox="0 0 16 16">
                  <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10m0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6"/>
                </svg>  
            </div>`}),interactive:!0}}ngAfterViewInit(){if(!this.mapDiv()?.nativeElement)throw"Map is not defined";if(!this.coords())throw"latLng can't be null";let e=new o.default.LatLng(41.3231,2.013304),t=o.default.map(this.mapDiv().nativeElement,this.getMapOptions());this.map.set(t),o.default.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(t),this.generateMarkers(this.events(),t),this.map().setView(this.coords()??e,16)}generateMarkers(e,t){e.forEach(n=>{let a=o.default.marker(new o.default.LatLng(+n.lat,+n.lon),this.getOptionsMarker()).addTo(t);return a.bindPopup(`<h4>${n.denominaci}</h4><a href="${h.BASE_HREF}/init/event/${n.codi}">M\xE9s info...</a>`),a.on("click",()=>a.openPopup()),a})}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=m({type:r,selectors:[["map"]],viewQuery:function(t,n){t&1&&u(n.mapDiv,b,5),t&2&&g()},decls:2,vars:0,consts:[["map",""]],template:function(t,n){t&1&&d(0,"div",null,0)},styles:["div[_ngcontent-%COMP%]{z-index:1;width:100vw;height:100vh}@media (min-width:1024px){div[_ngcontent-%COMP%]{width:75vw;height:100vh}}"]})};export{p as default};
